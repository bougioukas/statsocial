# Descriptive statistics {#sec-descriptive}

```{r}
#| include: false

library(tidyverse)
library(here)
library(kableExtra)

library(fontawesome)
library(scales)
library(ggsci)
library(ggpubr)
library(MESS)
library(questionr)

library(readxl)
rses1 <- read_excel(here("data", "rses1.xlsx"))
rses1$sex <- factor(rses1$sex, labels = c("male", "female"))
rses1$Score_cat <- factor(rses1$Score_cat, levels = c("low", "medium", "high"))
```

When we have finished this chapter, we should be able to:

::: {.callout-caution icon="false"}
## `r fa("circle-dot", prefer_type = "regular", fill = "red")` Learning objectives

-   Use frequency counts and percentages to describe categorical variables.
-   Display frequency distributions for categorical variables using bar plots.
-   Use statistical measures such as mean, median, standard deviation and interquartile range to describe numerical variables.
-   Generate and assess visualizations like histograms, density plots, and box plots to understand the distribution and spread of numerical data.
:::

 

## Data

We will explore a dataset containing 258 participants (rows) and 8 variables (columns). The variables include sex (female/male), age (in years), time spent on the internet and social media (in hours), the total score (0-30) from responses to 10 questions on the Rosenberg Self-Esteem Scale ([RSES](https://socy.umd.edu/about-us/using-rosenberg-self-esteem-scale)), and the categorization of that score into three levels of self-esteem: low (0-15), medium (16-19), and high (20-30)  [@garcía2019].

 

```{r}
#| echo: false
#| message: false

DT::datatable(
  rses1, extensions = 'Buttons', options = list(
    dom = 'tip'
  )
)

```

 

## Summarizing categorical data (Frequency Statistics)

### One variable frequency tables

The first step in analyzing a categorical variable is to count the occurrences of each label and calculate their frequencies. This collection of frequencies for all possible categories is known as the **frequency distribution** of the variable. Additionally, we can express these frequencies as proportions of the total number of observations, which are referred to as **relative frequencies**. If we multiply these proportions by 100, we obtain **percentages** (%).

 

**Sex variable**

Let's create a a frequency table for the `sex` variable:

![Fequency table for the sex.](images/tb001.png){#fig-tb001 width="70%"}

The table displays the following:

-   **Absolute frequency (n):** The number of participants in each category (male: 109, female: 149).

-   **Percentage (%):** The proportion of participants in each category relative to the total number of participants (relative frequency) multiplied by 100% (male: 109/258 x 100 = 42.2%, female: 149/258 x 100 = 57.8%). Note that the percentages sum up to 100% (42.2% + 57.8%).

-   **Cumulative percentage (%):** The sum of the percentage contributions of all categories up to and including the current one. For example, for the male category, the cumulative percentage is 42.2%. When combining male and female categories, the cumulative percentage is 42.2% + 57.8% = 100%. Therefore, the final cumulative percentage must equal 100%.


While frequency tables are extremely useful, plotting the data often provides a clearer presentation. For categorical variables, such as sex, it is straightforward to display the number of occurrences in each category using **bar plots**. The x-axis typically represents the categories of the variable—in this case, "male" and "female". The y-axis represents the frequency or count of occurrences for each category.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-barsex1
#| fig-cap: Bar plot showing the frequency distribution of the sex.
#| fig-width: 5
#| fig-height: 4.5

# create a data frame with sex groups and their counts
dat0 <- rses1 |> 
  count(sex)

# plot the data
ggplot(dat0, aes(x = sex, y = n)) +
  geom_col(width=0.65, fill = "#0073C2") +
  geom_text(aes(label=n),
            vjust=1.6, color = "white", size = 3.5) +
  labs(x = "Sex", y = "Frequency") +
  theme_minimal(base_size = 14)
```

\vspace{15pt}

If the y-axis represents percentages (%), then each bar's height corresponds to the percentage of participants in that category. For example, the percentage of female participants is 57.8%.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-barsex2
#| fig-cap: Bar plot showing the percentage of participants for each level of self-esteem.
#| fig-width: 5
#| fig-height: 4.5


# create a data frame with self-esteem levels, their counts, and percentages
dat1 <- dat0 |> 
  mutate(pct = round_percent(n, 1))

# plot the data
ggplot(dat1, aes(x = sex, y = pct)) +
  geom_col(width=0.65, fill = "#0073C2") +
  geom_text(aes(label=paste0(pct, "%")),
            vjust=1.6, color = "white", size = 3.5) +
  labs(x = "Sex", y = "Percentage") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal(base_size = 14)
```

 

**Score_cat variable (self-esteem)**

Similarly, we can create the frequency table for the `Score_cat` (self-esteem) variable:

![Frequency table for the levels of self-esteem.](images/tb002.png){#fig-tb002 width="70%"}

In the above table, we observe that 40.3% (104 out of 258) of participants have a low level of self-esteem. When we combine the low and medium categories, the cumulative percentage is: 40.3% + 32.6% = 72.9%. Finally, for all categories (low, medium, high), the cumulative percentage sums to 72.9% + 27.1% = 100%.


@fig-baresteem1 illustrates the frequency distribution of self-esteem. The horizontal axis (*x-axis*) displays the different self-esteem categories, ordered according to increasing self-esteem levels, while the vertical axis (y-axis) shows the frequency of each category.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-baresteem1
#| fig-cap: Bar plot showing the frequency for each level of self-esteem.
#| fig-width: 5
#| fig-height: 4.5


# create a data frame with self-esteem levels and their counts
dat2 <- rses1 |> 
  count(Score_cat)

# plot the data
ggplot(dat2, aes(x = Score_cat, y = n)) +
  geom_col(width=0.65, fill = "#0073C2") +
  geom_text(aes(label=n),
            vjust=1.6, color = "white", size = 3.5) +
  labs(x = "Self-esteem", y = "Frequency") +
  theme_minimal(base_size = 14)
```


@fig-baresteem2 illustrates the distribution of self-esteem using percentages. Most participants fall into the category of low self-esteem, accounting for 40.3% (172 out of 428), highlighting a significant portion of the sample that may benefit from targeted interventions or support.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-baresteem2
#| fig-cap: Bar plot showing the percentage of participants for each level of self-esteem.
#| fig-width: 5
#| fig-height: 4.5


# create a data frame with self-esteem levels, their counts, and percentages
dat3 <- dat2 |> 
  mutate(pct = round_percent(n, 1))

# plot the data
ggplot(dat3, aes(x = Score_cat, y = pct)) +
  geom_col(width=0.65, fill = "#0073C2") +
  geom_text(aes(label=paste0(pct, "%")),
            vjust=1.6, color = "white", size = 3.5) +
  labs(x = "Self-esteem", y = "Percentage") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal(base_size = 14)
```

 

::: callout-important
## Tips for simple bar plots

-   All bars should have equal width and equal spacing between them.
-   The height of each bar should correspond to the data it represents.
-   The bars should be plotted against a **common zero-valued baseline**.
:::


### Two variable tables (Contingency tables)

**A. Frequency contingency table**

In addition to tabulating each categorical variable separately, we might be interested in the distribution of self-esteem levels (categorized as low, medium, and high) among male and female participants in the dataset. This can be achieved by creating a frequency **contingency table**, as shown in @fig-tb0. Each cell value in the table represents the number of occurrences (frequency) corresponding to the combination of categories from the two different variables.

![Frequency contingency table which cross tabulates sex and self-esteem levels. Each cell value in the table represents the count corresponding to the combination of categories from the two variables.](images/tb0.png){#fig-tb0 width="70%"}

**Note:** The table also typically includes **row and column totals**, also known as marginal totals, that sum the counts for each row and column, respectively.


 

**B. Joint distribution contingency table**

A **joint distribution** contingency table displays both the frequency of observations across categories of two variables and the **percentage distributions** of those frequencies. The percentages are calculated by dividing the frequency in each cell by the **overall total** (258), then multiplying the result by 100. This shows the percentage of the total observations that fall into each category combination.

![Joint distribution contingency table. The percentages are calculated by dividing the frequency in each cell by the overall total.](images/tb1.png){#fig-tb1 width="75%"}

 

**C. Conditional distribution contingency table**

Suppose we are interested in the distribution of **self-esteem levels** within each sex group, meaning we are observing how self-esteem vary **among males** and **among females**.
By **conditioning** on sex, we divide each cell's frequency by the corresponding **row total** (row marginal total), rather than the overall total. This method allows us to examine the **conditional distribution** of self-esteem within each sex group. For example, the percentage of participants with low self-esteem, given that the participant is female, is calculated as (78/149) x 100 ≈ 52.4%.

![Conditional distribution contingency table. The percentages are calculated by dividing the frequency in each cell by the row marginal total.](images/tb2.png){#fig-tb2 width="75%"}

This data analysis indicates notable differences in self-esteem levels between male and female participants. Specifically, the percentage of female participants with low self-esteem (52.4%) is substantially greater than that of male participants (23.9%).

 

::: {.callout-tip icon="false"}
## `r fa("comment", fill = "#1DC5CE")` Comment

If we are interested in the distribution of **sex** within each self-esteem level, focusing on how the proportion of males and females varies within each self-esteem category, we condition on self-esteem. This means we divide each cell's frequency by the corresponding **column total**. For example, among those with low self-esteem, the percentage of females is (78/104) x 100 ≈ 75.0%

:::

We can also graphically present the data in the table shown in @fig-tb2. A side-by-side bar plot (@fig-sidebar) or, preferably, a grouped bar plot (@fig-groupbar) can facilitate easier visual comparisons.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-sidebar
#| fig-cap: Side-by-side bar plot showing by self-esteem level and sex.
#| fig-width: 7
#| fig-height: 5.5

# create a data frame with ordered self-esteem levels and their counts by sex
dat4 <- rses1 |> 
  count(Score_cat, sex) |>  
  group_by(sex) |> 
  mutate(pct = round_percent(n, 1)) |> 
  ungroup()

ggplot(dat4) + 
  geom_col(aes(Score_cat, pct, fill = sex), width = 0.7, position = "dodge") +
  geom_text(aes(Score_cat, pct, label = paste0(pct, "%"), 
                group = sex), color = "white", size = 3.5, vjust=1.2,
            position = position_dodge(width = .9)) +
  labs(x = "Self-esteem", y = "Percentage") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  scale_fill_jco() +
  theme_minimal(base_size = 14) +
  theme(legend.position="none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  facet_wrap(~sex, ncol = 2)
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-groupbar
#| fig-cap: Grouped bar plot showing by self-esteem level and sex.
#| fig-width: 8
#| fig-height: 5

ggplot(dat4) + 
  geom_col(aes(Score_cat, pct, fill = sex), width = 0.8, position = "dodge") +
  geom_text(aes(Score_cat, pct, label = paste0(pct, "%"), 
                group = sex), color = "white", size = 3.5, vjust=1.2,
            position = position_dodge(width = .9)) +
  labs(x = "Self-esteem", y = "Percentage") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  scale_fill_jco() +
  theme_minimal(base_size = 14)

```

Alternatively, we can create a stacked bar plot, where the bars are segmented by self-esteem levels. @fig-stackbar illustrates a **100% stacked bar plot**, which displays the percentage of each self-esteem level (low, medium, high) among male and female participants, emphasizing the relative differences within each group. 
For example, the plot shows that a higher proportion of females have low self-esteem (52.4%) compared to males (23.9%), while males have a higher proportion of medium (43.1%) and high self-esteem (33%) compared to females.


```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-stackbar
#| fig-cap: A horizontal stacked bar plot showing the distribution of self-esteem stratified by sex.
#| fig-width: 8
#| fig-height: 2.5

# create a data frame with self-esteem levels and their counts by sex
dat5 <- rses1 |> 
  group_by(sex) |> 
  count(Score_cat) |> 
  mutate(pct = round_percent(n, 2)) |> 
  ungroup()

ggplot(dat5, aes(x = sex, y = pct, fill = forcats::fct_rev(Score_cat)))+
  geom_bar(stat = "identity", width = 0.8)+
  geom_text(aes(label = paste0(round(pct, 1), "%"), y = pct), size = 3,
            position = position_stack(vjust = 0.5)) +
  coord_flip()+
  scale_fill_simpsons() +
  scale_y_continuous(labels = scales::percent_format(scale = 1))+
  labs(x = "Sex", y = "Percentage", fill = "Self-esteem") +
  theme_minimal(base_size = 14)
```


\vspace{10pt}

::: callout-warning
## Caution

One consideration when using stacked bar plots is the number of variable levels: with many categories, stacked bar plots can become confusing.
:::
